#!/bin/bash

echo "Starting initialization script..."

# Create static directory and favicon
mkdir -p static

# Create a minimal binary favicon to ensure it exists
echo -ne '\x00\x00\x01\x00\x01\x00\x10\x10\x00\x00\x01\x00\x20\x00\x68\x04\x00\x00\x16\x00\x00\x00\x89\x50\x4E\x47\x0D\x0A\x1A\x0A\x00\x00\x00\x0D\x49\x48\x44\x52\x00\x00\x00\x10\x00\x00\x00\x10\x08\x06\x00\x00\x00\x1F\xF3\xFF\x61\x00\x00\x00\x01\x73\x52\x47\x42\x00\xAE\xCE\x1C\xE9\x00\x00\x00\x04\x67\x41\x4D\x41\x00\x00\xB1\x8F\x0B\xFC\x61\x05\x00\x00\x00\x09\x70\x48\x59\x73\x00\x00\x0E\xC3\x00\x00\x0E\xC3\x01\xC7\x6F\xA8\x64\x00\x00\x00\x13\x49\x44\x41\x54\x38\x4F\x63\x60\x18\x05\xA3\x60\x14\x8C\x82\x51\x00\x04\x00\x06\x00\x02\x00\x01\x4D\x04\x1E\xCA\x00\x00\x00\x00\x49\x45\x4E\x44\xAE\x42\x60\x82' > static/favicon.ico

# Run the Python initialization script
python railway_startup.py || echo "Initialization script failed but continuing"

# Make sure the log file exists and is writable
touch jira_discord.log
chmod 666 jira_discord.log || true

# Check if templates directory exists, create if not
mkdir -p templates

echo "Initialization complete"